[{
		"bid": [{
			"id": "prebid-demo-response-mraid-load-and-events",
			"price": 0.15,
			"adm": "<html>\n<head>\n    <script>\n\n  /* Copywrite Aron Schatz 2018\n *\n *\n */\n\n\nfunction 
$(element)\n{\n\telement = document.getElementById(element);\n\treturn element;\n}\nvar head = 
document.getElementsByTagName(\"head\")[0];\nvar scr = document.createElement(\"script\");\nscr.setAttribute('src', 
'mraid.js');\nscr.setAttribute('type', 'text/javascript');\nhead.appendChild(scr);\nvar style = 
document.createElement('style');\nstyle.setAttribute('type', 
'text/css')\nstyle.appendChild(document.createTextNode('input{vertical-align:middle;} body{padding:5px;} a{color:#d00;  
text-decoration:none;} #aroniabmraid3ad{background:#ddd; color:#000; position:relative; font-size:14px; height:100%;} 
#checklog{position:absolute; right:0; bottom:0; font-size:24px; height:50px; display:flex; align-items:center;} #checklog 
a{outline:1px solid #a00; background:#fff; display:block; height:44px; line-height:44px; text-align:center; padding:0 3px;} 
#checklog a#expand{width:100px;} #step{} #step a{font-size:20px;} div#log{display:none; position:absolute; bottom:0; 
width:100%; height:150px; background:#111; color:#ddd; overflow-y:scroll; 
font-size:12px;}'));\nhead.appendChild(style);\nwindow._adclose=false;\nwindow._step=0;\nwindow._logclose=0;\nwindow._log=[];\n// 
Viewport setup\nvar meta = document.querySelector(\"meta[name=viewport]\");\nif (!meta)\n{\n  meta = 
document.createElement(\"meta\");\n  meta.name = \"viewport\";\n  meta.content = 
\"width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1\";\n  head.appendChild(meta);\n}\nelse\n{\n  
meta.content = \"width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1\";\n}\nvar checkenv=false;\nvar 
checkload=false;\nvar checkready=false;\nvar checkdefault=false;\n\nfunction logmessage(message)\n{ //Dual logging. It will 
show in the console and in the ad.\n\tconsole.log(\"MRAID_DEBUG: \" + message);\n\tvar logdiv = 
$('log');\n\tif(logdiv)\n\t{\n            if(Array.isArray(window._log))\n            {\n                var msg='';\n                
while(window._log.length)\n                {\n                    msg=window._log.shift();\n                    
logdiv.insertBefore(document.createElement(\"br\"),logdiv.firstChild);\n                    
logdiv.insertBefore(document.createTextNode(msg),logdiv.firstChild);\n                }\n                window._log=null;\n            
}\n            logdiv.insertBefore(document.createElement(\"br\"),logdiv.firstChild);\n            
logdiv.insertBefore(document.createTextNode(new Date().getTime()+\": \"+message),logdiv.firstChild);\n\t}\n\telse\n        
{\n            window._log.push(new Date().getTime()+\": \"+message);\n        }\n}\n\n\n//Check MRAID_ENV\nif(typeof 
window.MRAID_ENV!='undefined')\n{\n    checkenv=true;\n    logmessage(\"CHECK: Detected MRAID_ENV\");\n    
logmessage(\"Version: \"+window.MRAID_ENV.version+\" SDK: \"+window.MRAID_ENV.sdk+\" SDKv: 
\"+window.MRAID_ENV.sdkVersion);\n}\nelse\n{\n     logmessage(\"FAIL: window.MRAID_ENV is not 
detected\");\n}\n\n\n\nfunction readycheck()\n{\n\tlogmessage('window.onload() triggered.');\n\tif(mraid.getState() == 
'loading')\n\t{\n        logmessage(\"CHECK: In loading state. \" + 
mraid.getState());\n\t\tmraid.addEventListener(\"ready\", ready);\n\t}\n\telse\n\t{\n\t\tlogmessage(\"CHECK: init 
ad.\");\n\t\tinitad();\n\t}\n\tmraid.addEventListener('error', mraiderror);\n\tmraid.addEventListener('stateChange', 
statechange);\n\tmraid.addEventListener('sizeChange', sizechange);\n        if(mraid.getVersion=='3.0') //To get by with 
MRAID 2 SDK for now\n        {\n            mraid.addEventListener('audioVolumeChange', volumechange);\n        
}\n\tmraid.removeEventListener('stateChange', statechange);\n\tmraid.addEventListener('stateChange', statechange); //Just to 
check that removing and adding the same event listener works.\n\tlogmessage(\"CHECK: listeners added.\");\n}\n\nfunction 
ready()\n{\n\t//Inject a style\n\tconsole.log(\"READY FIRED\");\n\tlogmessage('Ready event 
fired.');\n\tinitad();\n}\n\nfunction initad()\n{\n\t//Inject a style\n\tlogmessage('initad() triggered.');\n\tvar gcp = 
mraid.getCurrentPosition();\n        var expp = mraid.getExpandProperties();\n        expp.useCustomClose=true;//This should 
have no effect.\n        mraid.setExpandProperties(expp);\n\tif(mraid.getState()==\"default\")\n        {\n         
logmessage(\"CHECK: State is default after ready\");\n        }\n        logmessage(\"MRAID Version: 
\"+mraid.getVersion());\n        window._maxsize=mraid.getMaxSize();\n        //Now setup content\n        var head = 
document.getElementsByTagName(\"head\")[0];\n\tvar style = document.createElement('style');\n\tstyle.setAttribute('type', 
'text/css')\n\tstyle.appendChild(document.createTextNode('body{padding:5px;}'));\n\thead.appendChild(style);\n\tvar 
parentdiv = $('aroniabmraid3ad');\n\tvar checklogdiv = document.createElement(\"div\"); //This is where buttons 
go\n\tchecklogdiv.id = 'checklog';\n        var link=document.createElement('a');\n        
link.setAttribute('onclick',\"expand()\");\n        link.appendChild(document.createTextNode('See Log'))\n        
link.setAttribute('id',\"expand\");\n        link.style.display='none';\n        checklogdiv.appendChild(link);\n        var 
link=document.createElement('a');\n        link.setAttribute('onclick',\"close()\");\n        
link.appendChild(document.createTextNode('Hide Log To Continue'))\n        link.setAttribute('id',\"close\");\n        
link.style.display='none';\n        checklogdiv.appendChild(link);\n\tparentdiv.appendChild(checklogdiv);\n\tvar stepdiv = 
document.createElement(\"div\"); // This is pure information\n        
stepdiv.setAttribute('id','step');\n\tparentdiv.appendChild(stepdiv);\n\t/*var waterdiv = document.createElement(\"div\"); 
//This is to show how sizing is working, visually\n\twaterdiv.id = 
'waterdiv';\n\twaterdiv.appendChild(document.createTextNode(\"IAB MRAID3 Events Compliance 
Ad.\"));\n\tparentdiv.appendChild(waterdiv);*/\n\tvar logdiv = document.createElement(\"div\"); //A generic div for showing 
logmessage inline...\n        logdiv.setAttribute('id','log');\n\tparentdiv.appendChild(logdiv);\n        
stepchange(1);\n}\n\nfunction stepchange(step)\n{\n\tlogmessage(\"stepchange \" + step);\n\n    //Clear everything from 
stepdiv, first\n    var stepdiv=$('step');\n    while (stepdiv.firstChild)\n    {\n            
stepdiv.removeChild(stepdiv.firstChild);\n    }\n\n    var div=document.createElement('div');\n\n    switch(step)\n    {\n        
case 1:\n            var link=document.createElement('a');\n            
link.setAttribute('onclick',\"expandstatecheck()\");\n            link.appendChild(document.createTextNode('Tap For 
Expand/stateChange Check'))\n            div.appendChild(link);\n            break;\n        case 2:\n            var 
span=document.createElement('span');\n            span.appendChild(document.createTextNode('Tap SDK Close Button'))\n            
div.appendChild(span);\n            break;\n        case 3:\n            var link=document.createElement('a');\n            
link.setAttribute('onclick',\"expandsizecheck()\");\n            link.appendChild(document.createTextNode('Tap For 
Expand/sizeChange Check'))\n            div.appendChild(link);\n            break;\n        case 4:\n            var 
link=document.createElement('a');\n            link.setAttribute('onclick',\"expandsizeclose()\");\n            
link.appendChild(document.createTextNode('Tap To Close Expand'))\n            div.appendChild(link);\n            break;\n        
case 5:\n            var link=document.createElement('a');\n            link.setAttribute('onclick',\"expandlog()\");\n            
link.appendChild(document.createTextNode('Tap To Check Logs'))\n            div.appendChild(link);\n            break;\n        
case 6:\n            var link=document.createElement('a');\n            link.setAttribute('onclick',\"unload()\");\n            
link.appendChild(document.createTextNode('Tap To Unload'))\n            div.appendChild(link);\n            break;\n    }\n    
stepdiv.appendChild(div);\n}\n\nfunction statechange(state)\n{\n\t    console.log(\"state change log property \" + 
$('log'));\n\n\tupdateprops(\"State Change\");\n\t    console.log(\"state change state \" + state);\n        
$('log').style.display='none';\n        if(window._logclose==1 && state=='default') //Handle the close button case\n        
{\n            $('step').style.display='break';\n            $('expand').style.display='block';\n            
$('close').style.display='none';\n            window._logclose=0;\n        }\n        if(state=='expanded')\n        {\n         
$('log').style.display='block';\n        }\n}\n\n\nfunction orientationchange()\n{\n\tupdateprops(\"Orientation 
Change\");\n}\n\nfunction mraiderror(message,action)\n{\n\tupdateprops(\"MRAID Error: '\"+message+\"' From: 
\"+action);\n}\n\nfunction sizechange()\n{\n    updateprops(\"Size Change\");\n}\n\nfunction updateprops(event)\n{\n\tvar 
gcp = mraid.getCurrentPosition();\n\tvar gss = mraid.getScreenSize();\n\tvar expp = mraid.getExpandProperties();\n\tvar 
orient = 'Undefined!';\n\tswitch (window.orientation)\n\t{\n\tcase 0:\n\tcase 180:\n\t\torient = 
'Portrait';\n\t\tbreak;\n\tcase 90:\n\tcase -90:\n\t\torient = 'Landscape';\n\t\tbreak;\n\t}\n\tlogmessage(\"[Cur: x: \" + 
gcp.x + \", y: \" + gcp.y + \", width: \" + gcp.width + \", height: \" + gcp.height+\"] [\"+\n\t  \"Window: x: \" + 
window.innerWidth + \", y: \" + window.innerHeight+\"] [\"+\n\t  \"Scr: width: \" + gss.width + \", height: \" + 
gss.height+\"] [\"+\n\t  \"expProps: width: \" + expp.width + \", height: \" + expp.height +\"] [\"+\n\t  \"Current 
orientation: \" + orient+\"] [\"+\n          \"State: \" + mraid.getState()+\"] [\"+\n          \"Last Event: \" + 
event+\"]\"\n\t);\n}\n\n\nfunction expand()\n{\n    mraid.expand();\n    //Show close to continue\n    
$('step').style.display='none';\n    $('expand').style.display='none';\n    $('close').style.display='block';\n    
window._logclose=1;\n}\n\nfunction close()\n{\n    mraid.close();\n    //Show steps again\n    
$('step').style.display='block';\n    $('expand').style.display='block';\n    
$('close').style.display='none';\n}\n\nfunction unload()\n{\n    updateprops('Unload');\n    
mraid.unload();\n\n}\n\nwindow.addEventListener('orientationchange', orientationchange, 
false);\n\nif(document.readyState==\"complete\")\n{\nlogmessage(\"readyState 
complete\");\n\treadycheck();\n}\nelse\n{\n\twindow.addEventListener('load', readycheck, false); //DOM and MRAID 
check\n}\n\n\n\n\n\n\n//Sequenced functions\n\nfunction expandstatecheck()\n{\n    //Add an event listener only for state 
change for this check\n    mraid.addEventListener('stateChange',expandstatechecklisten);\n    mraid.expand();\n}\n\nfunction 
expandstatechecklisten()\n{\n //Check state, check sizing\n    var curpos=mraid.getCurrentPosition();\n    
if(curpos.width==mraid.getMaxSize().width && curpos.height==mraid.getMaxSize().height && mraid.getState()=='expanded')\n    
{\n        logmessage('CHECK: Variables check upon stateChange after expand');\n    }\n    else\n    {\n        
logmessage('FAIL: Variables check upon stateChange after expand');\n    }\n    
mraid.removeEventListener('stateChange',expandstatechecklisten);\n    
mraid.addEventListener('stateChange',manualclosechecklisten);\n    stepchange(2);\n}\n\nfunction 
manualclosechecklisten()\n{\n //Check state, check sizing\n    var curpos=mraid.getCurrentPosition();\n    
if(curpos.width==mraid.getDefaultPosition().width && curpos.height==mraid.getDefaultPosition().height && 
mraid.getState()=='default')\n    {\n        logmessage('CHECK: Variables check upon stateChange after manual close');\n    
}\n    else\n    {\n        logmessage('FAIL: Variables check upon stateChange after manual close');\n    }\n    
mraid.removeEventListener('stateChange',manualclosechecklisten);\n    stepchange(3);\n}\n\nfunction expandsizecheck()\n{\n    
//Add an event listener only for size change for this check\n    
mraid.addEventListener('sizeChange',expandsizechecklisten);\n\tmraid.expand();\n}\n\nfunction expandsizechecklisten()\n{\n 
//Check state, check sizing\n    var curpos=mraid.getCurrentPosition();\n    if(curpos.width==mraid.getMaxSize().width && 
curpos.height==mraid.getMaxSize().height && mraid.getState()=='expanded')\n    {\n        logmessage('CHECK: Variables check 
upon sizeChange after expand');\n    }\n    else\n    {\n        logmessage('FAIL: Variables check upon sizeChange after 
expand');\n    }\n    mraid.removeEventListener('sizeChange',expandsizechecklisten);\n    stepchange(4);\n}\n\nfunction 
expandsizeclose()\n{\n    mraid.addEventListener('sizeChange',adclosesizechecklisten);\n    mraid.close();\n}\n\nfunction 
adclosesizechecklisten()\n{\n  //Check state, check sizing\n    var curpos=mraid.getCurrentPosition();\n    
if(curpos.width==mraid.getDefaultPosition().width && curpos.height==mraid.getDefaultPosition().height && 
mraid.getState()=='default')\n    {\n        logmessage('CHECK: Variables check upon sizeChange after ad close');\n    }\n    
else\n    {\n        logmessage('FAIL: Variables check upon sizeChange after ad close');\n    }\n    
mraid.removeEventListener('sizeChange',adclosesizechecklisten);\n    stepchange(5);\n}\n\nfunction expandlog()\n{\n    
stepchange(6);\n    $('checklog').style.display='none'; //Last step, remove this\n    mraid.expand();\n}\n    
</script>\n</head>\n<body>\n<div id=\"aroniabmraid3ad\"></div>\n</body>\n</html><script 
type=\"text/javascript\">\n(function(){\n  var supportMraid = window.mraid;\n  var isMraid = false;\n  
document.querySelectorAll('script').forEach(function(item) {\n    if (item.src.match('mraid.js')) isMraid = true;\n  });  \n  
if (supportMraid && isMraid) {\n    mraid.isViewable() ? track() : mraid.addEventListener('viewableChange', function() {\n      
mraid.isViewable() && track();\n    });\n  } else if (!isMraid) track();\n\n  function track() {\n    var pixel = new 
Image();\n    pixel.src = 
'https://prebid-server-test-j.prebid.org/win/prebid?p=FIRST&t=2DAABBgABAAECAAIBAAsAAgAAAJocGApOODZJZDBBaXllHBaOoJqD_8XanV8W07zCxsjXy6zVAQAcFpCN6rWKyMHInwEWzdqP6KujgNC0AQAWlu-k9wsVBgAsHBUCABwVAgAAHCb-hJaFBBUOFQQmuKHxgwQWoICcgATWrAIAHCaew6CABBaEovGDBBaUhZaFBBaQhZaFBBUUHBRkFIAFABUEFQgWrAImrAJFCAAAAA&ph=a51065ab-17ee-4394-b5a7-32debc04780a';\n    
track = function(){};\n  }\n})();\n</script>\n",
			"crid": "542294346",
			"w": 320,
			"h": 50,
			"ext": {
				"prebid": {
					"type": "banner"
				}
			}
		}],
		"seat": "prebid"
	}]
